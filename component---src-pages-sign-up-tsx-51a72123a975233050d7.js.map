{"version":3,"file":"component---src-pages-sign-up-tsx-51a72123a975233050d7.js","mappings":"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","sources":["webpack:///./src/componets/log-in/login.tsx","webpack:///./src/database/functions.ts","webpack:///./src/database/session-repair.ts","webpack:///./src/componets/sign-up/SignUpV2.tsx","webpack:///./src/pages/sign-up.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { navigate } from \"gatsby\";\nimport { FiArrowRight } from \"react-icons/fi\";\nimport { supabase } from \"../../database/supabaseClient\";\nimport { handleLogin } from \"../../database/functions\";\nimport { repairSupabaseKeysIfBroken, saveValidSupabaseKeys } from \"../../database/session-repair\";\n\ninterface LoginProps {\n  route?: Record<\n    string,\n    {\n      onTrue?: string;\n      onFalse?: string;\n    }\n  >;\n}\n\nconst Login: React.FC<LoginProps> = ({ route }) => {\n  const [formData, setFormData] = useState({\n    email: \"\",\n    password: \"\",\n    remember: false,\n  });\n\n  const [message, setMessage] = useState(\"\");\n\n  /* ---------------------------------\n     AUTO REDIRECT IF LOGGED IN\n  ---------------------------------- */\n  useEffect(() => {\n    supabase.auth.getSession().then(({ data }) => {\n      const role = data.session?.user?.user_metadata?.role;\n      if (data.session) handleRedirect(role);\n    });\n  }, []);\n\n  const handleRedirect = (role?: string | null) => {\n    if (role && route?.[role]?.onTrue) return navigate(route[role].onTrue!);\n    if (role && route?.[role]?.onFalse) return navigate(route[role].onFalse!);\n    navigate(\"/event/aid/checkout\");\n  };\n\n  const clearStaleSupabaseKeys = () => {\n    Object.keys(localStorage).forEach((key) => {\n      if (key.startsWith(\"sb-\")) localStorage.removeItem(key);\n    });\n  };\n\n  const onSuccess = async () => {\n    const { data } = await supabase.auth.getSession();\n    saveValidSupabaseKeys();\n    const role = data.session?.user?.user_metadata?.role;\n    setMessage(\"Login successful\");\n    setTimeout(() => handleRedirect(role), 900);\n  };\n\n  const onFail = (err?: string) => {\n    setMessage(err || \"Invalid credentials\");\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value, type, checked } = e.target;\n    setFormData((p) => ({ ...p, [name]: type === \"checkbox\" ? checked : value }));\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    repairSupabaseKeysIfBroken();\n    clearStaleSupabaseKeys();\n    handleLogin({\n      email: formData.email,\n      password: formData.password,\n      onSuccess,\n      onFail,\n    });\n  };\n\n  const styles = authStyle\n  /* ---------------------------------\n     APPLEâ€‘STYLE CLEAN UI\n  ---------------------------------- */\n  return (\n    <div style={styles.page}>\n      <div style={styles.card}>\n        <div style={styles.header}>\n          <h1 style={styles.logo}>AID</h1>\n          <p style={styles.tagline}>A.I. Director</p>\n        </div>\n\n        <form onSubmit={handleSubmit} style={styles.form}>\n          <div style={styles.field}>\n            <label style={styles.label}>Email</label>\n            <input\n              style={styles.input}\n              type=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div style={styles.field}>\n            <label style={styles.label}>Password</label>\n            <input\n              style={styles.input}\n              type=\"password\"\n              name=\"password\"\n              value={formData.password}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div style={styles.row}>\n            <label style={styles.checkbox}>\n              <input\n                type=\"checkbox\"\n                name=\"remember\"\n                checked={formData.remember}\n                onChange={handleChange}\n              />\n              Remember me\n            </label>\n            <a href=\"/reset-password\" style={styles.link}>Forgot?</a>\n          </div>\n\n          <button type=\"submit\" style={styles.button}>\n            Sign In <FiArrowRight />\n          </button>\n\n          {message && <div style={styles.message}>{message}</div>}\n        </form>\n\n        <div style={styles.footer}>\n          Donâ€™t have an account? <a href=\"/sign-up\" style={styles.link}>Create one</a>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n\n/* ---------------------------------\n   INLINE APPLEâ€‘STYLE DESIGN\n---------------------------------- */\nexport const authStyle: Record<string, React.CSSProperties> = {\n  page: {\n    minHeight: \"100vh\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    background: \"#ffffff\",\n        color : 'black',\n    fontFamily: \"-apple-system, BlinkMacSystemFont, SF Pro Text, Helvetica Neue, Arial\",\n  },\n  card: {\n    width: 380,\n    padding: \"2.5rem\",\n    borderRadius: 16,\n    border: \"1px solid #e5e5e7\",\n    background: \"#fff\",\n  },\n  header: {\n    marginBottom: \"2rem\",\n    textAlign: \"center\",\n  },\n  logo: {\n    margin: 0,\n    fontSize: \"1.8rem\",\n    fontWeight: 600,\n  },\n  tagline: {\n    marginTop: 6,\n    fontSize: \"0.9rem\",\n    color: \"#000\",\n  },\n  form: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    gap: \"1.2rem\",\n  },\n  field: {\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  label: {\n    fontSize: \"0.7rem\",\n    textTransform: \"uppercase\",\n    fontWeight: 600,\n    marginBottom: 6,\n    letterSpacing: \"0.05em\",\n    color : 'black'\n  },\n  input: {\n    padding: \"0.7rem\",\n    borderRadius: 8,\n    border: \"1px solid #d2d2d7\",\n    fontSize: \"0.9rem\",\n  },\n  row: {\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    fontSize: \"0.85rem\",\n  },\n  checkbox: {\n    display: \"flex\",\n    alignItems: \"center\",\n    gap: 6,\n  },\n  button: {\n    marginTop: \"1rem\",\n    padding: \"0.8rem\",\n    borderRadius: 10,\n    border: \"none\",\n    background: \"#000\",\n    color: \"#fff\",\n    fontSize: \"0.95rem\",\n    cursor: \"pointer\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: 8,\n  },\n  link: {\n    color: \"#000\",\n    textDecoration: \"none\",\n  },\n  footer: {\n    marginTop: \"1.5rem\",\n    textAlign: \"center\",\n    fontSize: \"0.85rem\",\n    color: \"#000\",\n  },\n  message: {\n    marginTop: 10,\n    textAlign: \"center\",\n    fontSize: \"0.85rem\",\n  },\n};\n","import { clearStaleSupabaseKeys } from \"./session-repair\";\nimport { supabase } from \"./supabaseClient\";\n\n\n\n\n\n\nexport const handleLogout = async ({ onSuccess, onFail } = {}) => {\n  console.log(\"ðŸ” Logging outâ€¦\");\n\n  // Remove corrupted keys ONLY\n  clearStaleSupabaseKeys();\n\n  // Call Supabase logout\n  const { error } = await supabase.auth.signOut();\n\n  if (error) {\n    console.error(\"âŒ Logout error:\", error);\n    return onFail?.(error.message);\n  }\n\n  // Clear *all* session keys (safe now)\n  clearStaleSupabaseKeys();\n\n  // Optionally wipe saved session map\n  localStorage.removeItem(\"__thv_valid_supabase_keys__\");\n\n  onSuccess?.();\n};\n\n\n\n\n\nexport const handleSignup = async ({\n  email,\n  password,\n  fullName,\n  onSuccess,\n  onFail,\n}: {\n  email: string\n  password: string\n  fullName?: string\n  onSuccess?: () => void\n  onFail?: (error?: string) => void\n}) => {\n  const { data, error } = await supabase.auth.signUp({\n    email,\n    password,\n    options: {\n      data: {\n        full_name: fullName || \"unknown\",\n        signup_source: \"thv-web\", // optional\n      },\n    },\n  })\n\n  if (error) onFail?.(error.message)\n  else onSuccess?.()\n}\n\n\nexport const handleLogin = async (\n  { email, password, onSuccess, onFail }: {\n    email: string\n    password: string\n    onSuccess?: () => void\n    onFail?: (error?: string) => void\n  }\n) => {\n  const { data, error } = await supabase.auth.signInWithPassword({ email, password })\n  if (error) onFail?.(error.message)\n  else onSuccess?.()\n}\n\nexport const handleResetPassword = async (\n  { email, onSuccess, onFail }: {\n    email: string\n    onSuccess?: () => void\n    onFail?: (error?: string) => void\n  }\n) => {\n  const { data, error } = await supabase.auth.resetPasswordForEmail(email)\n  if (error) onFail?.(error.message)\n  else onSuccess?.()\n}\n\nexport const handleUpdatePassword = async (\n  { newPassword, onSuccess, onFail }: {\n    newPassword: string\n    onSuccess?: () => void\n    onFail?: (error?: string) => void\n  }\n) => {\n  const { data, error } = await supabase.auth.updateUser({ password: newPassword })\n  if (error) onFail?.(error.message)\n  else onSuccess?.()\n}\n\n\n\nexport interface UpdateUserData {\n  fullName?: string;\n  phone?: string;\n  email?: string;\n  dob?: string;\n  address?: string;\n  hometown?: string;\n  field?: string;\n  goals?: string;\n  vision?: string;\n  status?: string;\n  avatar?: string;\n}\n\n/**\n * Updates user profile data across both tables: user_member & user_private\n * Automatically maps field names to Supabase column names.\n */\nexport const updateUserProfile = async (updates: UpdateUserData) => {\n  try {\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) throw new Error('Not logged in');\n\n    const memberPayload: any = {};\n    const privatePayload: any = {};\n\n    if (updates.fullName) memberPayload.full_name = updates.fullName;\n    if (updates.hometown) memberPayload.hometown = updates.hometown;\n    if (updates.field) memberPayload.field_of_expertise = updates.field;\n    if (updates.status) memberPayload.profile_status = updates.status;\n    if (updates.avatar) memberPayload.avatar_url = updates.avatar;\n\n    if (updates.phone) privatePayload.phone = updates.phone;\n    if (updates.email) privatePayload.email = updates.email;\n    if (updates.address) privatePayload.address = updates.address;\n    if (updates.dob) privatePayload.dob = updates.dob;\n    if (updates.goals) privatePayload.personal_goals = updates.goals;\n    if (updates.vision) privatePayload.future_vision = updates.vision;\n\n    // Run updates separately depending on which data is provided\n    if (Object.keys(memberPayload).length > 0)\n      await supabase.from('user_member').update(memberPayload).eq('id', user.id);\n\n    if (Object.keys(privatePayload).length > 0)\n      await supabase.from('user_private').update(privatePayload).eq('id', user.id);\n\n    return { success: true };\n  } catch (error) {\n    console.error('Update user profile failed:', error);\n    return { success: false, error };\n  }\n};\n","export function getSupabaseAuthKeys() {\n  return Object.keys(localStorage).filter(k =>\n    k.startsWith(\"sb-\") && k.includes(\"-auth-token\")\n  );\n}\n\n// Save session keys after successful login\nexport function saveValidSupabaseKeys() {\n  const keys = getSupabaseAuthKeys();\n  if (keys.length === 0) return;\n\n  const store: Record<string, string> = {};\n  keys.forEach(k => (store[k] = localStorage.getItem(k) || \"\"));\n\n  localStorage.setItem(\"__thv_valid_supabase_keys__\", JSON.stringify(store));\n}\n\n// Restore missing / damaged keys BEFORE login\nexport function repairSupabaseKeysIfBroken() {\n  const saved = localStorage.getItem(\"__thv_valid_supabase_keys__\");\n  if (!saved) return;\n\n  const good = JSON.parse(saved);\n  Object.keys(good).forEach(k => {\n    if (!localStorage.getItem(k)) {\n      console.log(\"ðŸ›  Restoring missing Supabase key:\", k);\n      localStorage.setItem(k, good[k]);\n    }\n  });\n}\n\n// Remove corrupted keys\nexport function clearStaleSupabaseKeys() {\n  const saved = JSON.parse(localStorage.getItem(\"__thv_valid_supabase_keys__\") || \"{}\");\n  const current = getSupabaseAuthKeys();\n\n  current.forEach(k => {\n    if (!saved[k]) {\n      console.log(\"ðŸ§¨ Removing stale Supabase key:\", k);\n      localStorage.removeItem(k);\n    }\n  });\n}\n","import React, { useState, useEffect } from 'react';\nimport { navigate } from 'gatsby';\nimport { FiArrowRight } from 'react-icons/fi';\nimport { handleSignup } from '../../database/functions';\nimport { authStyle } from '../log-in/login';\n\nexport const RESEND_SOURCES = {\n  THV: \"tinh-hoa-viet\",\n  AID: \"aid\",\n} as const;\n\nexport type ResendSource = typeof RESEND_SOURCES[keyof typeof RESEND_SOURCES];\nconst EMAIL_SOURCE: ResendSource = RESEND_SOURCES.THV;\n\nconst i18n = {\n  EN: {\n    begin: 'Create Your Account',\n    sub: 'Join the platform',\n    fullName: 'Full Name',\n    email: 'Email',\n    password: 'Password',\n    confirmPassword: 'Confirm Password',\n    passwordHint: 'At least 8 characters',\n    terms1: 'I agree to the ',\n    tos: 'Terms',\n    and: ' and ',\n    privacy: 'Privacy Policy',\n    submit: 'Create Account',\n    have: 'Already have an account? ',\n    login: 'Sign In',\n  }\n};\n\nconst SignUpV2: React.FC = () => {\n  const [formData, setFormData] = useState({\n    fullName: '',\n    email: '',\n    password: '',\n    confirmPassword: '',\n    agree: false\n  });\n\n  const [message, setMessage] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const t = i18n.EN;\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value, type, checked } = e.target;\n    setFormData(p => ({ ...p, [name]: type === 'checkbox' ? checked : value }));\n  };\n\n  const onSuccess = async () => {\n    setMessage('Check your email for verification');\n    navigate('/check-email');\n  };\n\n  const onFail = (err?: string) => {\n    setMessage(err || 'Signup failed');\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (submitting) return;\n    setSubmitting(true);\n\n    handleSignup({\n      email: formData.email,\n      password: formData.password,\n      fullName: formData.fullName,\n      onSuccess,\n      onFail\n    });\n  };\n\n    const styles = authStyle\n\n  return (\n    <div style={styles.page}>\n      <div style={styles.card}>\n        <div style={styles.header}>\n          <h1 style={styles.logo}>AID</h1>\n          <p style={styles.tagline}>Create Account</p>\n        </div>\n\n        <form onSubmit={handleSubmit} style={styles.form}>\n          <div style={styles.field}>\n            <label style={styles.label}>{t.fullName}</label>\n            <input\n              style={styles.input}\n              name=\"fullName\"\n              value={formData.fullName}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div style={styles.field}>\n            <label style={styles.label}>{t.email}</label>\n            <input\n              style={styles.input}\n              type=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div style={styles.field}>\n            <label style={styles.label}>{t.password}</label>\n            <input\n              style={styles.input}\n              type=\"password\"\n              name=\"password\"\n              value={formData.password}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div style={styles.field}>\n            <label style={styles.label}>{t.confirmPassword}</label>\n            <input\n              style={styles.input}\n              type=\"password\"\n              name=\"confirmPassword\"\n              value={formData.confirmPassword}\n              onChange={handleChange}\n              required\n            />\n          </div>\n{/*           \n          <label style={styles.checkbox}>\n            <input\n              type=\"checkbox\"\n              name=\"agree\"\n              checked={formData.agree}\n              onChange={handleChange}\n              required\n            />\n            {t.terms1}<a href=\"#\">{t.tos}</a><div style={{ fontSize : 10 }} ></div>{t.and}<a href=\"#\">{t.privacy}</a>\n          </label>\n\n          <button type=\"submit\" style={styles.button} disabled={submitting}>\n            {t.submit} <FiArrowRight />\n          </button>\n\n          {message && <div style={styles.message}>{message}</div>} */}\n        </form>\n\n        <div style={styles.footer}>\n          {t.have}<a href=\"/sign-in\" style={styles.link}>{t.login}</a>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SignUpV2;\n","import React from 'react'\nimport Signupform from '../componets/sign-up/SignUpV2'\nconst Signup = () => {\n \n  return (\n    <main >\n      <Signupform/>\n    </main>\n  )\n}\n\nexport default Signup\n"],"names":["_ref","route","formData","setFormData","useState","email","password","remember","message","setMessage","useEffect","supabase","auth","getSession","then","_ref2","data","role","session","_data$session","user","_data$session$user","user_metadata","_data$session$user$us","handleRedirect","_route$role","onTrue","navigate","_route$role2","onFalse","onSuccess","async","saveValidSupabaseKeys","_data$session2","_data$session2$user","_data$session2$user$u","setTimeout","onFail","err","handleChange","e","name","value","type","checked","target","p","styles","authStyle","React","style","page","card","header","logo","tagline","onSubmit","preventDefault","repairSupabaseKeysIfBroken","Object","keys","localStorage","forEach","key","startsWith","removeItem","handleLogin","form","field","label","input","onChange","required","row","checkbox","href","link","button","FiArrowRight","footer","minHeight","display","alignItems","justifyContent","background","color","fontFamily","width","padding","borderRadius","border","marginBottom","textAlign","margin","fontSize","fontWeight","marginTop","flexDirection","gap","textTransform","letterSpacing","cursor","textDecoration","handleLogout","console","log","clearStaleSupabaseKeys","error","signOut","handleSignup","fullName","signUp","options","full_name","signup_source","signInWithPassword","handleResetPassword","resetPasswordForEmail","handleUpdatePassword","newPassword","updateUser","getSupabaseAuthKeys","filter","k","includes","length","store","getItem","setItem","JSON","stringify","saved","good","parse","i18n","begin","sub","confirmPassword","passwordHint","terms1","tos","and","privacy","submit","have","login","SignUpV2","agree","submitting","setSubmitting","t","Signup","Signupform"],"sourceRoot":""}