{"version":3,"file":"component---src-pages-test-logout-tsx-ccda11b84bcb80c8f53d.js","mappings":"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","sources":["webpack:///./src/componets/log-in/login.tsx","webpack:///./src/database/functions.ts","webpack:///./src/pages/test/logout.tsx","webpack:///./src/componets/auth/Logout/Logout.tsx","webpack:///./src/database/session-repair.ts"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { navigate } from \"gatsby\";\nimport { FiArrowRight } from \"react-icons/fi\";\nimport { supabase } from \"../../database/supabaseClient\";\nimport { handleLogin } from \"../../database/functions\";\nimport { repairSupabaseKeysIfBroken, saveValidSupabaseKeys } from \"../../database/session-repair\";\n\ninterface LoginProps {\n  route?: Record<\n    string,\n    {\n      onTrue?: string;\n      onFalse?: string;\n    }\n  >;\n}\n\nconst Login: React.FC<LoginProps> = ({ route }) => {\n  const [formData, setFormData] = useState({\n    email: \"\",\n    password: \"\",\n    remember: false,\n  });\n\n  const [message, setMessage] = useState(\"\");\n\n  /* ---------------------------------\n     AUTO REDIRECT IF LOGGED IN\n  ---------------------------------- */\n  useEffect(() => {\n    supabase.auth.getSession().then(({ data }) => {\n      const role = data.session?.user?.user_metadata?.role;\n      if (data.session) handleRedirect(role);\n    });\n  }, []);\n\n  const handleRedirect = (role?: string | null) => {\n    if (role && route?.[role]?.onTrue) return navigate(route[role].onTrue!);\n    if (role && route?.[role]?.onFalse) return navigate(route[role].onFalse!);\n    navigate(\"/event/aid/checkout\");\n  };\n\n  const clearStaleSupabaseKeys = () => {\n    Object.keys(localStorage).forEach((key) => {\n      if (key.startsWith(\"sb-\")) localStorage.removeItem(key);\n    });\n  };\n\n  const onSuccess = async () => {\n    const { data } = await supabase.auth.getSession();\n    saveValidSupabaseKeys();\n    const role = data.session?.user?.user_metadata?.role;\n    setMessage(\"Login successful\");\n    setTimeout(() => handleRedirect(role), 900);\n  };\n\n  const onFail = (err?: string) => {\n    setMessage(err || \"Invalid credentials\");\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value, type, checked } = e.target;\n    setFormData((p) => ({ ...p, [name]: type === \"checkbox\" ? checked : value }));\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    repairSupabaseKeysIfBroken();\n    clearStaleSupabaseKeys();\n    handleLogin({\n      email: formData.email,\n      password: formData.password,\n      onSuccess,\n      onFail,\n    });\n  };\n\n  const styles = authStyle\n  /* ---------------------------------\n     APPLEâ€‘STYLE CLEAN UI\n  ---------------------------------- */\n  return (\n    <div style={styles.page}>\n      <div style={styles.card}>\n        <div style={styles.header}>\n          <h1 style={styles.logo}>AID</h1>\n          <p style={styles.tagline}>A.I. Director</p>\n        </div>\n\n        <form onSubmit={handleSubmit} style={styles.form}>\n          <div style={styles.field}>\n            <label style={styles.label}>Email</label>\n            <input\n              style={styles.input}\n              type=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div style={styles.field}>\n            <label style={styles.label}>Password</label>\n            <input\n              style={styles.input}\n              type=\"password\"\n              name=\"password\"\n              value={formData.password}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div style={styles.row}>\n            <label style={styles.checkbox}>\n              <input\n                type=\"checkbox\"\n                name=\"remember\"\n                checked={formData.remember}\n                onChange={handleChange}\n              />\n              Remember me\n            </label>\n            <a href=\"/reset-password\" style={styles.link}>Forgot?</a>\n          </div>\n\n          <button type=\"submit\" style={styles.button}>\n            Sign In <FiArrowRight />\n          </button>\n\n          {message && <div style={styles.message}>{message}</div>}\n        </form>\n\n        <div style={styles.footer}>\n          Donâ€™t have an account? <a href=\"/sign-up\" style={styles.link}>Create one</a>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n\n/* ---------------------------------\n   INLINE APPLEâ€‘STYLE DESIGN\n---------------------------------- */\nexport const authStyle: Record<string, React.CSSProperties> = {\n  page: {\n    minHeight: \"100vh\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    background: \"#ffffff\",\n        color : 'black',\n    fontFamily: \"-apple-system, BlinkMacSystemFont, SF Pro Text, Helvetica Neue, Arial\",\n  },\n  card: {\n    width: 380,\n    padding: \"2.5rem\",\n    borderRadius: 16,\n    border: \"1px solid #e5e5e7\",\n    background: \"#fff\",\n  },\n  header: {\n    marginBottom: \"2rem\",\n    textAlign: \"center\",\n  },\n  logo: {\n    margin: 0,\n    fontSize: \"1.8rem\",\n    fontWeight: 600,\n  },\n  tagline: {\n    marginTop: 6,\n    fontSize: \"0.9rem\",\n    color: \"#000\",\n  },\n  form: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    gap: \"1.2rem\",\n  },\n  field: {\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  label: {\n    fontSize: \"0.7rem\",\n    textTransform: \"uppercase\",\n    fontWeight: 600,\n    marginBottom: 6,\n    letterSpacing: \"0.05em\",\n    color : 'black'\n  },\n  input: {\n    padding: \"0.7rem\",\n    borderRadius: 8,\n    border: \"1px solid #d2d2d7\",\n    fontSize: \"0.9rem\",\n  },\n  row: {\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    fontSize: \"0.85rem\",\n  },\n  checkbox: {\n    display: \"flex\",\n    alignItems: \"center\",\n    gap: 6,\n  },\n  button: {\n    marginTop: \"1rem\",\n    padding: \"0.8rem\",\n    borderRadius: 10,\n    border: \"none\",\n    background: \"#000\",\n    color: \"#fff\",\n    fontSize: \"0.95rem\",\n    cursor: \"pointer\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: 8,\n  },\n  link: {\n    color: \"#000\",\n    textDecoration: \"none\",\n  },\n  footer: {\n    marginTop: \"1.5rem\",\n    textAlign: \"center\",\n    fontSize: \"0.85rem\",\n    color: \"#000\",\n  },\n  message: {\n    marginTop: 10,\n    textAlign: \"center\",\n    fontSize: \"0.85rem\",\n  },\n};\n","import { clearStaleSupabaseKeys } from \"./session-repair\";\nimport { supabase } from \"./supabaseClient\";\n\n\n\n\n\n\nexport const handleLogout = async ({ onSuccess, onFail } = {}) => {\n  console.log(\"ðŸ” Logging outâ€¦\");\n\n  // Remove corrupted keys ONLY\n  clearStaleSupabaseKeys();\n\n  // Call Supabase logout\n  const { error } = await supabase.auth.signOut();\n\n  if (error) {\n    console.error(\"âŒ Logout error:\", error);\n    return onFail?.(error.message);\n  }\n\n  // Clear *all* session keys (safe now)\n  clearStaleSupabaseKeys();\n\n  // Optionally wipe saved session map\n  localStorage.removeItem(\"__thv_valid_supabase_keys__\");\n\n  onSuccess?.();\n};\n\n\n\n\n\nexport const handleSignup = async ({\n  email,\n  password,\n  fullName,\n  onSuccess,\n  onFail,\n}: {\n  email: string\n  password: string\n  fullName?: string\n  onSuccess?: () => void\n  onFail?: (error?: string) => void\n}) => {\n  const { data, error } = await supabase.auth.signUp({\n    email,\n    password,\n    options: {\n      data: {\n        full_name: fullName || \"unknown\",\n        signup_source: \"thv-web\", // optional\n      },\n    },\n  })\n\n  if (error) onFail?.(error.message)\n  else onSuccess?.()\n}\n\n\nexport const handleLogin = async (\n  { email, password, onSuccess, onFail }: {\n    email: string\n    password: string\n    onSuccess?: () => void\n    onFail?: (error?: string) => void\n  }\n) => {\n  const { data, error } = await supabase.auth.signInWithPassword({ email, password })\n  if (error) onFail?.(error.message)\n  else onSuccess?.()\n}\n\nexport const handleResetPassword = async (\n  { email, onSuccess, onFail }: {\n    email: string\n    onSuccess?: () => void\n    onFail?: (error?: string) => void\n  }\n) => {\n  const { data, error } = await supabase.auth.resetPasswordForEmail(email)\n  if (error) onFail?.(error.message)\n  else onSuccess?.()\n}\n\nexport const handleUpdatePassword = async (\n  { newPassword, onSuccess, onFail }: {\n    newPassword: string\n    onSuccess?: () => void\n    onFail?: (error?: string) => void\n  }\n) => {\n  const { data, error } = await supabase.auth.updateUser({ password: newPassword })\n  if (error) onFail?.(error.message)\n  else onSuccess?.()\n}\n\n\n\nexport interface UpdateUserData {\n  fullName?: string;\n  phone?: string;\n  email?: string;\n  dob?: string;\n  address?: string;\n  hometown?: string;\n  field?: string;\n  goals?: string;\n  vision?: string;\n  status?: string;\n  avatar?: string;\n}\n\n/**\n * Updates user profile data across both tables: user_member & user_private\n * Automatically maps field names to Supabase column names.\n */\nexport const updateUserProfile = async (updates: UpdateUserData) => {\n  try {\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) throw new Error('Not logged in');\n\n    const memberPayload: any = {};\n    const privatePayload: any = {};\n\n    if (updates.fullName) memberPayload.full_name = updates.fullName;\n    if (updates.hometown) memberPayload.hometown = updates.hometown;\n    if (updates.field) memberPayload.field_of_expertise = updates.field;\n    if (updates.status) memberPayload.profile_status = updates.status;\n    if (updates.avatar) memberPayload.avatar_url = updates.avatar;\n\n    if (updates.phone) privatePayload.phone = updates.phone;\n    if (updates.email) privatePayload.email = updates.email;\n    if (updates.address) privatePayload.address = updates.address;\n    if (updates.dob) privatePayload.dob = updates.dob;\n    if (updates.goals) privatePayload.personal_goals = updates.goals;\n    if (updates.vision) privatePayload.future_vision = updates.vision;\n\n    // Run updates separately depending on which data is provided\n    if (Object.keys(memberPayload).length > 0)\n      await supabase.from('user_member').update(memberPayload).eq('id', user.id);\n\n    if (Object.keys(privatePayload).length > 0)\n      await supabase.from('user_private').update(privatePayload).eq('id', user.id);\n\n    return { success: true };\n  } catch (error) {\n    console.error('Update user profile failed:', error);\n    return { success: false, error };\n  }\n};\n","import React from \"react\";\nimport Logout from \"../../componets/auth/Logout/Logout\";\n\nexport default () => <Logout/>","import React, { useEffect, useState } from \"react\";\nimport { navigate } from \"gatsby\";\nimport { handleLogout } from \"../../../database/functions\";\nimport { authStyle } from \"../../log-in/login\";\n\n\nconst i18n = {\n  EN: {\n    brandTitle: \"TINH HOA VIá»†T\",\n    tagline: \"Where Vietnamese Excellence Meets Global Recognition\",\n    loggingOut: \"Logging you out securelyâ€¦\",\n    success: \"\",\n    fail: \"âŒ Logout failed. Please try again.\",\n  },\n  VN: {\n    brandTitle: \"TINH HOA VIá»†T\",\n    tagline: \"NÆ¡i tÃ´n vinh tinh hoa Viá»‡t Nam vÆ°Æ¡n táº§m quá»‘c táº¿\",\n    loggingOut: \"Äang Ä‘Äƒng xuáº¥t an toÃ nâ€¦\",\n    success: \"âœ… Báº¡n Ä‘Ã£ Ä‘Äƒng xuáº¥t thÃ nh cÃ´ng.\",\n    fail: \"âŒ ÄÄƒng xuáº¥t tháº¥t báº¡i. Vui lÃ²ng thá»­ láº¡i.\",\n  },\n};\n\nconst Logout: React.FC = () => {\n  const [language] = useState<\"EN\" | \"VN\">(\"EN\");\n  const t = i18n[language];\n  const [status, setStatus] = useState(t.loggingOut);\n\n  useEffect(() => {\n    handleLogout({\n      onSuccess: () => {\n        setStatus(t.success);\n        setTimeout(() => navigate(\"/\"), 1500);\n      },\n      onFail: () => {\n        setStatus(t.fail);\n      },\n    });\n  }, []);\n\n  const styles = authStyle;\n\n  return (\n    <div style={styles.page}>\n      <div style={styles.card}>\n        <div style={styles.header}>\n          <h1 style={styles.logo}>AID</h1>\n          <p style={styles.tagline}>{t.tagline}</p>\n        </div>\n\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            alignItems: \"center\",\n            gap: 14,\n            marginTop: 10,\n          }}\n        >\n          {/* minimalist spinner */}\n          <div\n            style={{\n              width: 28,\n              height: 28,\n              borderRadius: \"50%\",\n              border: \"2px solid #d2d2d7\",\n              borderTopColor: \"#000\",\n              animation: \"spin 0.9s linear infinite\",\n            }}\n          />\n\n          <div style={styles.message}>{status}</div>\n        </div>\n      </div>\n\n      {/* inline keyframes, because weâ€™re staying self-contained */}\n      <style>\n        {`\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n        `}\n      </style>\n    </div>\n  );\n};\n\nexport default Logout;\n","export function getSupabaseAuthKeys() {\n  return Object.keys(localStorage).filter(k =>\n    k.startsWith(\"sb-\") && k.includes(\"-auth-token\")\n  );\n}\n\n// Save session keys after successful login\nexport function saveValidSupabaseKeys() {\n  const keys = getSupabaseAuthKeys();\n  if (keys.length === 0) return;\n\n  const store: Record<string, string> = {};\n  keys.forEach(k => (store[k] = localStorage.getItem(k) || \"\"));\n\n  localStorage.setItem(\"__thv_valid_supabase_keys__\", JSON.stringify(store));\n}\n\n// Restore missing / damaged keys BEFORE login\nexport function repairSupabaseKeysIfBroken() {\n  const saved = localStorage.getItem(\"__thv_valid_supabase_keys__\");\n  if (!saved) return;\n\n  const good = JSON.parse(saved);\n  Object.keys(good).forEach(k => {\n    if (!localStorage.getItem(k)) {\n      console.log(\"ðŸ›  Restoring missing Supabase key:\", k);\n      localStorage.setItem(k, good[k]);\n    }\n  });\n}\n\n// Remove corrupted keys\nexport function clearStaleSupabaseKeys() {\n  const saved = JSON.parse(localStorage.getItem(\"__thv_valid_supabase_keys__\") || \"{}\");\n  const current = getSupabaseAuthKeys();\n\n  current.forEach(k => {\n    if (!saved[k]) {\n      console.log(\"ðŸ§¨ Removing stale Supabase key:\", k);\n      localStorage.removeItem(k);\n    }\n  });\n}\n"],"names":["_ref","route","formData","setFormData","useState","email","password","remember","message","setMessage","useEffect","supabase","auth","getSession","then","_ref2","data","role","session","_data$session","user","_data$session$user","user_metadata","_data$session$user$us","handleRedirect","_route$role","onTrue","navigate","_route$role2","onFalse","onSuccess","async","saveValidSupabaseKeys","_data$session2","_data$session2$user","_data$session2$user$u","setTimeout","onFail","err","handleChange","e","name","value","type","checked","target","p","styles","authStyle","React","style","page","card","header","logo","tagline","onSubmit","preventDefault","repairSupabaseKeysIfBroken","Object","keys","localStorage","forEach","key","startsWith","removeItem","handleLogin","form","field","label","input","onChange","required","row","checkbox","href","link","button","FiArrowRight","footer","minHeight","display","alignItems","justifyContent","background","color","fontFamily","width","padding","borderRadius","border","marginBottom","textAlign","margin","fontSize","fontWeight","marginTop","flexDirection","gap","textTransform","letterSpacing","cursor","textDecoration","handleLogout","console","log","clearStaleSupabaseKeys","error","signOut","handleSignup","fullName","signUp","options","full_name","signup_source","signInWithPassword","handleResetPassword","resetPasswordForEmail","handleUpdatePassword","newPassword","updateUser","Logout","i18n","EN","brandTitle","loggingOut","success","fail","VN","language","t","status","setStatus","height","borderTopColor","animation","getSupabaseAuthKeys","filter","k","includes","length","store","getItem","setItem","JSON","stringify","saved","good","parse"],"sourceRoot":""}